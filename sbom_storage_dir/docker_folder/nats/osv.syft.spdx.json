{
  "results": [
    {
      "source": {
        "path": "/src/syft.spdx.json",
        "type": "sbom"
      },
      "packages": [
        {
          "package": {
            "name": "github.com/nats-io/nats-server/v2",
            "version": "v0.0.0-20231201180956-77e4ac6bc40c",
            "ecosystem": "Go",
            "commit": ""
          },
          "vulnerabilities": [
            {
              "modified": "2023-11-08T04:03:20Z",
              "published": "2021-05-21T16:11:49Z",
              "schema_version": "1.6.0",
              "id": "GHSA-2c64-vj8g-vwrq",
              "aliases": [
                "CVE-2020-26892",
                "GHSA-4w5x-x539-ppf5",
                "GO-2022-0380"
              ],
              "summary": "Incorrect handling of credential expiry by /nats-io/nats-server",
              "details": "(This advisory is canonically https://advisories.nats.io/CVE/CVE-2020-26892.txt )\n\n## Problem Description\n\nNATS nats-server through 2020-10-07 has Incorrect Access Control because of how expired credentials are handled.\n\nThe NATS accounts system has expiration timestamps on credentials; the \u003chttps://github.com/nats-io/jwt\u003e library had an API which encouraged misuse and an `IsRevoked()` method which misused its own API.\n\nA new `IsClaimRevoked()` method has correct handling and the nats-server has been updated to use this.  The old `IsRevoked()` method now always returns true and other client code will have to be updated to avoid calling it.\n\nThe CVE identifier should cover any application using the old JWT API, where the nats-server is one of those applications.\n\n\n## Affected versions\n\n#### JWT library\n\n * all versions prior to 1.1.0\n * fixed after nats-io/jwt PR 103 landed (2020-10-06)\n\n#### NATS Server\n\n * Version 2 prior to 2.1.9\n   + 2.0.0 through and including 2.1.8 are vulnerable.\n * fixed with nats-io/nats-server PRs 1632, 1635, 1645\n\n\n## Impact\n\nTime-based credential expiry did not work.\n\n\n## Workaround\n\nHave credentials which only expire after fixes can be deployed.\n\n\n## Solution\n\nUpgrade the JWT dependency in any application using it.\n\nUpgrade the NATS server if using NATS Accounts.",
              "affected": [
                {
                  "package": {
                    "ecosystem": "Go",
                    "name": "github.com/nats-io/nats-server/v2",
                    "purl": "pkg:golang/github.com/nats-io/nats-server/v2"
                  },
                  "ranges": [
                    {
                      "type": "SEMVER",
                      "events": [
                        {
                          "introduced": "0"
                        },
                        {
                          "fixed": "2.1.9"
                        }
                      ]
                    }
                  ],
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-2c64-vj8g-vwrq/GHSA-2c64-vj8g-vwrq.json"
                  }
                },
                {
                  "package": {
                    "ecosystem": "Go",
                    "name": "github.com/nats-io/jwt",
                    "purl": "pkg:golang/github.com/nats-io/jwt"
                  },
                  "ranges": [
                    {
                      "type": "SEMVER",
                      "events": [
                        {
                          "introduced": "0"
                        },
                        {
                          "fixed": "1.1.0"
                        }
                      ]
                    }
                  ],
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-2c64-vj8g-vwrq/GHSA-2c64-vj8g-vwrq.json"
                  }
                }
              ],
              "references": [
                {
                  "type": "WEB",
                  "url": "https://github.com/nats-io/nats-server/security/advisories/GHSA-2c64-vj8g-vwrq"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/nats-io/jwt/commit/e11ce317263cef69619fc1ca743b195d02aa1d8a"
                },
                {
                  "type": "WEB",
                  "url": "https://advisories.nats.io/CVE/CVE-2020-26892.txt"
                }
              ],
              "database_specific": {
                "cwe_ids": [
                  "CWE-284"
                ],
                "github_reviewed": true,
                "github_reviewed_at": "2021-05-20T22:19:22Z",
                "nvd_published_at": null,
                "severity": "HIGH"
              }
            },
            {
              "modified": "2023-11-08T04:03:20Z",
              "published": "2022-02-11T23:42:20Z",
              "schema_version": "1.6.0",
              "id": "GHSA-4w5x-x539-ppf5",
              "aliases": [
                "CVE-2020-26892",
                "GHSA-2c64-vj8g-vwrq",
                "GO-2022-0380"
              ],
              "summary": "Incorrect handling of credential expiry by /nats-io/nats-server",
              "details": "\n## Problem Description\n\nNATS nats-server through 2020-10-07 has Incorrect Access Control because of how expired credentials are handled.\n\nThe NATS accounts system has expiration timestamps on credentials; the \u003chttps://github.com/nats-io/jwt\u003e library had an API which encouraged misuse and an `IsRevoked()` method which misused its own API.\n\nA new `IsClaimRevoked()` method has correct handling and the nats-server has been updated to use this.  The old `IsRevoked()` method now always returns true and other client code will have to be updated to avoid calling it.\n\nThe CVE identifier should cover any application using the old JWT API, where the nats-server is one of those applications.\n\n\n## Affected versions\n\n#### JWT library\n\n * all versions prior to 1.1.0\n * fixed after nats-io/jwt PR 103 landed (2020-10-06)\n\n#### NATS Server\n\n * Version 2 prior to 2.1.9\n   + 2.0.0 through and including 2.1.8 are vulnerable.\n * fixed with nats-io/nats-server PRs 1632, 1635, 1645\n\n\n## Impact\n\nTime-based credential expiry did not work.\n\n\n## Workaround\n\nHave credentials which only expire after fixes can be deployed.\n\n\n## Solution\n\nUpgrade the JWT dependency in any application using it.\n\nUpgrade the NATS server if using NATS Accounts.",
              "affected": [
                {
                  "package": {
                    "ecosystem": "Go",
                    "name": "github.com/nats-io/jwt",
                    "purl": "pkg:golang/github.com/nats-io/jwt"
                  },
                  "ranges": [
                    {
                      "type": "SEMVER",
                      "events": [
                        {
                          "introduced": "0"
                        },
                        {
                          "fixed": "1.1.0"
                        }
                      ]
                    }
                  ],
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-4w5x-x539-ppf5/GHSA-4w5x-x539-ppf5.json"
                  }
                },
                {
                  "package": {
                    "ecosystem": "Go",
                    "name": "github.com/nats-io/nats-server/v2",
                    "purl": "pkg:golang/github.com/nats-io/nats-server/v2"
                  },
                  "ranges": [
                    {
                      "type": "SEMVER",
                      "events": [
                        {
                          "introduced": "0"
                        },
                        {
                          "fixed": "2.1.9"
                        }
                      ]
                    }
                  ],
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-4w5x-x539-ppf5/GHSA-4w5x-x539-ppf5.json"
                  }
                }
              ],
              "severity": [
                {
                  "type": "CVSS_V3",
                  "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
                }
              ],
              "references": [
                {
                  "type": "WEB",
                  "url": "https://github.com/nats-io/jwt/security/advisories/GHSA-4w5x-x539-ppf5"
                },
                {
                  "type": "ADVISORY",
                  "url": "https://nvd.nist.gov/vuln/detail/CVE-2020-26892"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/nats-io/jwt/commit/e11ce317263cef69619fc1ca743b195d02aa1d8a"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/nats-io/nats-server/commit/1e08b67f08e18cd844dce833a265aaa72500a12f"
                },
                {
                  "type": "WEB",
                  "url": "https://advisories.nats.io/CVE/CVE-2020-26892.txt"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/nats-io/nats-server/commits/master"
                },
                {
                  "type": "WEB",
                  "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VT67XCLIIBYRT762SVFBYFFTQFVSM3SI/"
                },
                {
                  "type": "WEB",
                  "url": "https://pkg.go.dev/vuln/GO-2022-0380"
                },
                {
                  "type": "WEB",
                  "url": "https://www.openwall.com/lists/oss-security/2020/11/02/2"
                }
              ],
              "database_specific": {
                "cwe_ids": [
                  "CWE-798"
                ],
                "github_reviewed": true,
                "github_reviewed_at": "2021-05-21T21:18:09Z",
                "nvd_published_at": "2020-11-06T08:15:00Z",
                "severity": "CRITICAL"
              }
            },
            {
              "modified": "2023-11-08T04:03:19Z",
              "published": "2022-02-11T23:43:13Z",
              "schema_version": "1.6.0",
              "id": "GHSA-h2fg-54x9-5qhq",
              "aliases": [
                "CVE-2020-26521",
                "GHSA-hmm9-r2m2-qg9w",
                "GO-2022-0402"
              ],
              "summary": "Nil dereference in NATS JWT, DoS of nats-server",
              "details": "## Problem Description\n\nThe NATS account system has an Operator trusted by the servers, which signs Accounts, and each Account can then create and sign Users within their account.  The Operator should be able to safely issue Accounts to other entities which it does not fully trust.\n\nA malicious Account could create and sign a User JWT with a state not created by the normal tooling, such that decoding by the NATS JWT library (written in Go) would attempt a nil dereference, aborting execution.\n\nThe NATS Server is known to be impacted by this.\n\n\n## Affected versions\n\n#### JWT library\n\n * all versions prior to 1.1.0\n\n#### NATS Server\n\n * Version 2 prior to 2.1.9\n\n\n## Impact\n\n#### JWT library\n\n * Programs would nil dereference and panic, aborting execution by default.\n\n#### NATS server\n\n * Denial of Service caused by process termination\n\n\n## Workaround\n\nIf your NATS servers do not trust any accounts which are managed by untrusted entities, then malformed User credentials are unlikely to be encountered.\n\n\n## Solution\n\nUpgrade the JWT dependency in any application using it.\n\nUpgrade the NATS server if using NATS Accounts.",
              "affected": [
                {
                  "package": {
                    "ecosystem": "Go",
                    "name": "github.com/nats-io/jwt",
                    "purl": "pkg:golang/github.com/nats-io/jwt"
                  },
                  "ranges": [
                    {
                      "type": "SEMVER",
                      "events": [
                        {
                          "introduced": "0"
                        },
                        {
                          "fixed": "1.1.0"
                        }
                      ]
                    }
                  ],
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-h2fg-54x9-5qhq/GHSA-h2fg-54x9-5qhq.json"
                  }
                },
                {
                  "package": {
                    "ecosystem": "Go",
                    "name": "github.com/nats-io/nats-server/v2",
                    "purl": "pkg:golang/github.com/nats-io/nats-server/v2"
                  },
                  "ranges": [
                    {
                      "type": "SEMVER",
                      "events": [
                        {
                          "introduced": "0"
                        },
                        {
                          "fixed": "2.1.9"
                        }
                      ]
                    }
                  ],
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-h2fg-54x9-5qhq/GHSA-h2fg-54x9-5qhq.json"
                  }
                }
              ],
              "severity": [
                {
                  "type": "CVSS_V3",
                  "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
                }
              ],
              "references": [
                {
                  "type": "WEB",
                  "url": "https://github.com/nats-io/jwt/security/advisories/GHSA-h2fg-54x9-5qhq"
                },
                {
                  "type": "ADVISORY",
                  "url": "https://nvd.nist.gov/vuln/detail/CVE-2020-26521"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/nats-io/jwt/pull/107"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/nats-io/nats-server/commit/9ff8bcde2e46009e98bd9e88f598af355f62c168"
                },
                {
                  "type": "WEB",
                  "url": "https://advisories.nats.io/CVE/CVE-2020-26521.txt"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/nats-io/nats-server/commits/master"
                },
                {
                  "type": "WEB",
                  "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VT67XCLIIBYRT762SVFBYFFTQFVSM3SI/"
                },
                {
                  "type": "WEB",
                  "url": "https://pkg.go.dev/vuln/GO-2022-0402"
                },
                {
                  "type": "WEB",
                  "url": "http://www.openwall.com/lists/oss-security/2020/11/02/2"
                }
              ],
              "database_specific": {
                "cwe_ids": [
                  "CWE-476"
                ],
                "github_reviewed": true,
                "github_reviewed_at": "2021-05-21T21:32:02Z",
                "nvd_published_at": "2020-11-06T08:15:00Z",
                "severity": "HIGH"
              }
            },
            {
              "modified": "2023-11-08T04:03:19Z",
              "published": "2021-05-21T16:22:10Z",
              "schema_version": "1.6.0",
              "id": "GHSA-hmm9-r2m2-qg9w",
              "aliases": [
                "CVE-2020-26521",
                "GHSA-h2fg-54x9-5qhq",
                "GO-2022-0402"
              ],
              "summary": "Nil dereference in NATS JWT causing DoS of nats-server",
              "details": "(This advisory is canonically \u003chttps://advisories.nats.io/CVE/CVE-2020-26521.txt\u003e)\n\n## Problem Description\n\nThe NATS account system has an Operator trusted by the servers, which signs Accounts, and each Account can then create and sign Users within their account.  The Operator should be able to safely issue Accounts to other entities which it does not fully trust.\n\nA malicious Account could create and sign a User JWT with a state not created by the normal tooling, such that decoding by the NATS JWT library (written in Go) would attempt a nil dereference, aborting execution.\n\nThe NATS Server is known to be impacted by this.\n\n\n## Affected versions\n\n#### JWT library\n\n * all versions prior to 1.1.0\n\n#### NATS Server\n\n * Version 2 prior to 2.1.9\n\n\n## Impact\n\n#### JWT library\n\n * Programs would nil dereference and panic, aborting execution by default.\n\n#### NATS server\n\n * Denial of Service caused by process termination\n\n\n## Workaround\n\nIf your NATS servers do not trust any accounts which are managed by untrusted entities, then malformed User credentials are unlikely to be encountered.\n\n\n## Solution\n\nUpgrade the JWT dependency in any application using it.\n\nUpgrade the NATS server if using NATS Accounts.",
              "affected": [
                {
                  "package": {
                    "ecosystem": "Go",
                    "name": "github.com/nats-io/nats-server/v2",
                    "purl": "pkg:golang/github.com/nats-io/nats-server/v2"
                  },
                  "ranges": [
                    {
                      "type": "SEMVER",
                      "events": [
                        {
                          "introduced": "0"
                        },
                        {
                          "fixed": "2.1.9"
                        }
                      ]
                    }
                  ],
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-hmm9-r2m2-qg9w/GHSA-hmm9-r2m2-qg9w.json"
                  }
                },
                {
                  "package": {
                    "ecosystem": "Go",
                    "name": "github.com/nats-io/jwt",
                    "purl": "pkg:golang/github.com/nats-io/jwt"
                  },
                  "ranges": [
                    {
                      "type": "SEMVER",
                      "events": [
                        {
                          "introduced": "0"
                        },
                        {
                          "fixed": "1.1.0"
                        }
                      ]
                    }
                  ],
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-hmm9-r2m2-qg9w/GHSA-hmm9-r2m2-qg9w.json"
                  }
                }
              ],
              "severity": [
                {
                  "type": "CVSS_V3",
                  "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
                }
              ],
              "references": [
                {
                  "type": "WEB",
                  "url": "https://github.com/nats-io/nats-server/security/advisories/GHSA-hmm9-r2m2-qg9w"
                },
                {
                  "type": "ADVISORY",
                  "url": "https://nvd.nist.gov/vuln/detail/CVE-2020-26521"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/nats-io/jwt/pull/107"
                },
                {
                  "type": "WEB",
                  "url": "https://advisories.nats.io/CVE/CVE-2020-26521.txt"
                },
                {
                  "type": "WEB",
                  "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VT67XCLIIBYRT762SVFBYFFTQFVSM3SI/"
                },
                {
                  "type": "WEB",
                  "url": "https://www.openwall.com/lists/oss-security/2020/11/02/2"
                }
              ],
              "database_specific": {
                "cwe_ids": [
                  "CWE-476"
                ],
                "github_reviewed": true,
                "github_reviewed_at": "2021-05-20T21:18:45Z",
                "nvd_published_at": null,
                "severity": "HIGH"
              }
            },
            {
              "modified": "2023-12-06T01:01:11Z",
              "published": "2022-02-15T01:57:18Z",
              "schema_version": "1.6.0",
              "id": "GHSA-9r5x-fjv3-q6h4",
              "aliases": [
                "BIT-nats-2021-3127",
                "CVE-2021-3127",
                "GHSA-62mh-w5cv-p88c",
                "GHSA-j756-f273-xhp4",
                "GO-2022-0386"
              ],
              "summary": "Incorrect Access Control in github.com/nats-io/jwt and github.com/nats-io/nats-server/v2",
              "details": "NATS Server (github.com/nats-io/nats-server/v2/server) 2.x before 2.2.0 and JWT library (github.com/nats-io/jwt/v2) before 2.0.1 have Incorrect Access Control because Import Token bindings are mishandled.",
              "affected": [
                {
                  "package": {
                    "ecosystem": "Go",
                    "name": "github.com/nats-io/jwt/v2",
                    "purl": "pkg:golang/github.com/nats-io/jwt/v2"
                  },
                  "ranges": [
                    {
                      "type": "SEMVER",
                      "events": [
                        {
                          "introduced": "0"
                        },
                        {
                          "fixed": "2.0.1"
                        }
                      ]
                    }
                  ],
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-9r5x-fjv3-q6h4/GHSA-9r5x-fjv3-q6h4.json"
                  }
                },
                {
                  "package": {
                    "ecosystem": "Go",
                    "name": "github.com/nats-io/nats-server/v2",
                    "purl": "pkg:golang/github.com/nats-io/nats-server/v2"
                  },
                  "ranges": [
                    {
                      "type": "SEMVER",
                      "events": [
                        {
                          "introduced": "0"
                        },
                        {
                          "fixed": "2.2.0"
                        }
                      ]
                    }
                  ],
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-9r5x-fjv3-q6h4/GHSA-9r5x-fjv3-q6h4.json"
                  }
                },
                {
                  "package": {
                    "ecosystem": "Go",
                    "name": "github.com/nats-io/jwt",
                    "purl": "pkg:golang/github.com/nats-io/jwt"
                  },
                  "ranges": [
                    {
                      "type": "SEMVER",
                      "events": [
                        {
                          "introduced": "0"
                        },
                        {
                          "fixed": "1.2.3-0.20210314221642-a826c77dc9d2"
                        }
                      ]
                    }
                  ],
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-9r5x-fjv3-q6h4/GHSA-9r5x-fjv3-q6h4.json"
                  }
                }
              ],
              "severity": [
                {
                  "type": "CVSS_V3",
                  "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"
                }
              ],
              "references": [
                {
                  "type": "ADVISORY",
                  "url": "https://nvd.nist.gov/vuln/detail/CVE-2021-3127"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/nats-io/jwt/pull/149/commits/a826c77dc9d2671c961b75ceefdb439c41029866"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/nats-io/nats-server/commit/423b79440c80c863de9f4e20548504e6c5d5e403"
                },
                {
                  "type": "WEB",
                  "url": "https://advisories.nats.io/CVE/CVE-2021-3127.txt"
                },
                {
                  "type": "PACKAGE",
                  "url": "https://github.com/nats-io/jwt"
                }
              ],
              "database_specific": {
                "cwe_ids": [
                  "CWE-284",
                  "CWE-863"
                ],
                "github_reviewed": true,
                "github_reviewed_at": "2021-05-12T20:34:10Z",
                "nvd_published_at": "2021-03-16T20:15:00Z",
                "severity": "HIGH"
              }
            },
            {
              "modified": "2023-12-06T01:01:11Z",
              "published": "2021-05-21T16:22:20Z",
              "schema_version": "1.6.0",
              "id": "GHSA-j756-f273-xhp4",
              "aliases": [
                "BIT-nats-2021-3127",
                "CVE-2021-3127",
                "GHSA-62mh-w5cv-p88c",
                "GHSA-9r5x-fjv3-q6h4",
                "GO-2022-0386"
              ],
              "summary": "github.com/nats-io/nats-server/ Import token permissions checking not enforced",
              "details": "(This advisory is canonically \u003chttps://advisories.nats.io/CVE/CVE-2021-3127.txt\u003e)\n\n## Problem Description\n\nThe NATS server provides for Subjects which are namespaced by Account; all Subjects are supposed to be private to an account, with an Export/Import system used to grant cross-account access to some Subjects.  Some Exports are public, such that anyone can import the relevant subjects, and some Exports are private, such that the Import requires a token JWT to prove permission.\n\nThe JWT library's validation of the bindings in the Import Token incorrectly warned on mismatches, instead of outright rejecting the token.\n\nAs a result, any account can take an Import token used by any other account and re-use it for themselves because the binding to the importing account is not rejected, and use it to import *any* Subject from the Exporting account, not just the Subject referenced in the Import Token.\n\nThe NATS account-server system treats account JWTs as semi-public information, such that an attacker can easily enumerate all account JWTs and retrieve all Import Tokens from those account JWTs.\n\nThe CVE identifier should cover the JWT library repair and the nats-server containing the fixed JWT library, and any other application depending upon the fixed JWT library.\n\n\n## Affected versions\n\n#### JWT library\n\n * all versions prior to 2.0.1\n * fixed after nats-io/jwt#149 landed (2021-03-14)\n\n#### NATS Server\n\n * Version 2 prior to 2.2.0\n   + 2.0.0 through and including 2.1.9 are vulnerable\n * fixed with nats-io/nats-server@423b79440c (2021-03-14)\n\n\n## Impact\n\nIn deployments with untrusted accounts able to update the Account Server with imports, a malicious account can access any Subject from an account which provides Exported Subjects.\n\nAbuse of this facility requires the malicious actor to upload their tampered Account JWT to the Account Server, providing the service operator with a data-store which can be scanned for signs of abuse.\n\n\n## Workaround\n\nDeny access to clients to update their account JWT in the account server.\n\n\n## Solution\n\nUpgrade the JWT dependency in any application using it.\n\nUpgrade the NATS server if using NATS Accounts (with private Exports; Account owners can create those at any time though).\n\nAudit all accounts JWTs to scan for exploit attempts; a Python script to audit the accounts can be found at \u003chttps://gist.github.com/philpennock/09d49524ad98043ff11d8a40c2bb0d5a\u003e.",
              "affected": [
                {
                  "package": {
                    "ecosystem": "Go",
                    "name": "github.com/nats-io/nats-server/v2",
                    "purl": "pkg:golang/github.com/nats-io/nats-server/v2"
                  },
                  "ranges": [
                    {
                      "type": "SEMVER",
                      "events": [
                        {
                          "introduced": "0"
                        },
                        {
                          "fixed": "2.2.0"
                        }
                      ]
                    }
                  ],
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-j756-f273-xhp4/GHSA-j756-f273-xhp4.json"
                  }
                },
                {
                  "package": {
                    "ecosystem": "Go",
                    "name": "github.com/nats-io/jwt",
                    "purl": "pkg:golang/github.com/nats-io/jwt"
                  },
                  "ranges": [
                    {
                      "type": "SEMVER",
                      "events": [
                        {
                          "introduced": "0"
                        },
                        {
                          "fixed": "1.2.3-0.20210314221642-a826c77dc9d2"
                        }
                      ]
                    }
                  ],
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-j756-f273-xhp4/GHSA-j756-f273-xhp4.json"
                  }
                },
                {
                  "package": {
                    "ecosystem": "Go",
                    "name": "github.com/nats-io/jwt/v2",
                    "purl": "pkg:golang/github.com/nats-io/jwt/v2"
                  },
                  "ranges": [
                    {
                      "type": "SEMVER",
                      "events": [
                        {
                          "introduced": "0"
                        },
                        {
                          "fixed": "2.0.1"
                        }
                      ]
                    }
                  ],
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-j756-f273-xhp4/GHSA-j756-f273-xhp4.json"
                  }
                }
              ],
              "severity": [
                {
                  "type": "CVSS_V3",
                  "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"
                }
              ],
              "references": [
                {
                  "type": "WEB",
                  "url": "https://github.com/nats-io/nats-server/security/advisories/GHSA-j756-f273-xhp4"
                },
                {
                  "type": "ADVISORY",
                  "url": "https://nvd.nist.gov/vuln/detail/CVE-2021-3127"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/nats-io/jwt/pull/149"
                },
                {
                  "type": "WEB",
                  "url": "https://advisories.nats.io/CVE/CVE-2021-3127.txt"
                }
              ],
              "database_specific": {
                "cwe_ids": [
                  "CWE-755",
                  "CWE-863"
                ],
                "github_reviewed": true,
                "github_reviewed_at": "2021-05-20T21:01:49Z",
                "nvd_published_at": null,
                "severity": "HIGH"
              }
            },
            {
              "modified": "2021-05-20T21:07:16Z",
              "published": "2021-05-21T16:22:16Z",
              "schema_version": "1.6.0",
              "id": "GHSA-gwj5-3vfq-q992",
              "summary": "Import loops in account imports, nats-server DoS",
              "details": "(This advisory is canonically \u003chttps://advisories.nats.io/CVE/CVE-2020-28466.txt\u003e)\n\n## Problem Description\n\nAn export/import cycle between accounts could crash the nats-server, after consuming CPU and memory.\n\nThis issue was fixed publicly in \u003chttps://github.com/nats-io/nats-server/pull/1731\u003e in November 2020.\n\nThe need to call this out as a security issue was highlighted by `snyk.io` and we are grateful for their assistance in doing so.\n\nOrganizations which run a NATS service providing access to accounts run by untrusted third parties are affected.\nSee below for an important caveat if running such a service.\n\n\n## Affected versions\n\n#### NATS Server\n\n * Version 2 prior to 2.2.0\n   + 2.0.0 through and including 2.1.9 are vulnerable.\n * fixed with nats-io/nats-server PR 1731, commit 2e3c226729\n\n\n## Impact\n\nThe nats-server could be killed, after consuming resources.\n\n\n## Workaround\n\nThe import cycle requires at least two accounts to work; if you have open account sign-up, then restricting new account sign-up might hinder an attacker.\n\n\n## Solution\n\nUpgrade the nats-server.\n\n\n## Caveat on NATS with untrusted users\n\nRunning a NATS service which is exposed to untrusted users presents a heightened risk.\n\nAny remote execution flaw or equivalent seriousness, or denial-of-service by unauthenticated users, will lead to prompt releases by the NATS maintainers.\n\nFixes for denial of service issues with no threat of remote execution, when limited to account holders, are likely to just be committed to the main development branch with no special attention.\n\nThose who are running such services are encouraged to build regularly from git.",
              "affected": [
                {
                  "package": {
                    "ecosystem": "Go",
                    "name": "github.com/nats-io/nats-server/v2",
                    "purl": "pkg:golang/github.com/nats-io/nats-server/v2"
                  },
                  "ranges": [
                    {
                      "type": "SEMVER",
                      "events": [
                        {
                          "introduced": "0"
                        },
                        {
                          "fixed": "2.2.0"
                        }
                      ]
                    }
                  ],
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-gwj5-3vfq-q992/GHSA-gwj5-3vfq-q992.json"
                  }
                }
              ],
              "severity": [
                {
                  "type": "CVSS_V3",
                  "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
                }
              ],
              "references": [
                {
                  "type": "WEB",
                  "url": "https://github.com/nats-io/nats-server/security/advisories/GHSA-gwj5-3vfq-q992"
                }
              ],
              "database_specific": {
                "cwe_ids": [
                  "CWE-400"
                ],
                "github_reviewed": true,
                "github_reviewed_at": "2021-05-20T21:07:16Z",
                "nvd_published_at": null,
                "severity": "LOW"
              }
            },
            {
              "modified": "2023-11-08T04:01:07Z",
              "published": "2021-05-18T18:14:55Z",
              "schema_version": "1.6.0",
              "id": "GHSA-jp4j-47f9-2vc3",
              "aliases": [
                "CVE-2019-13126"
              ],
              "summary": "Integer Overflow or Wraparound in NATS Server",
              "details": "An integer overflow in NATS Server before 2.2.0 allows a remote attacker to crash the server by sending a crafted request.\n\n### Specific Go Packages Affected\ngithub.com/nats-io/nats-server/v2/server",
              "affected": [
                {
                  "package": {
                    "ecosystem": "Go",
                    "name": "github.com/nats-io/nats-server/v2",
                    "purl": "pkg:golang/github.com/nats-io/nats-server/v2"
                  },
                  "ranges": [
                    {
                      "type": "SEMVER",
                      "events": [
                        {
                          "introduced": "0"
                        },
                        {
                          "fixed": "2.2.0"
                        }
                      ]
                    }
                  ],
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2021/05/GHSA-jp4j-47f9-2vc3/GHSA-jp4j-47f9-2vc3.json"
                  }
                }
              ],
              "severity": [
                {
                  "type": "CVSS_V3",
                  "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
                }
              ],
              "references": [
                {
                  "type": "ADVISORY",
                  "url": "https://nvd.nist.gov/vuln/detail/CVE-2019-13126"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/nats-io/nats-server/pull/1053"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/nats-io/nats-server/pull/1441"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/nats-io/nats-server/commit/07ef71ff98f45f8c2711be4aeaf484610d891dda"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/nats-io/nats-server/commits/master"
                },
                {
                  "type": "WEB",
                  "url": "https://www.twistlock.com/labs-blog/finding-dos-vulnerability-nats-go-fuzz-cve-2019-13126/"
                }
              ],
              "database_specific": {
                "cwe_ids": [
                  "CWE-190"
                ],
                "github_reviewed": true,
                "github_reviewed_at": "2021-05-17T16:35:04Z",
                "nvd_published_at": "2019-07-29T17:15:00Z",
                "severity": "HIGH"
              }
            },
            {
              "modified": "2023-12-06T01:00:30Z",
              "published": "2022-02-15T01:57:18Z",
              "schema_version": "1.6.0",
              "id": "GHSA-m4jx-6526-vvhm",
              "aliases": [
                "BIT-nats-2020-28466",
                "CVE-2020-28466",
                "SNYK-GOLANG-GITHUBCOMNATSIONATSSERVERSERVER-1042967"
              ],
              "summary": "Denial of service in github.com/nats-io/nats-server/server",
              "details": "This affects all versions of package github.com/nats-io/nats-server/server. Untrusted accounts are able to crash the server using configs that represent a service export/import cycles. Disclaimer from the maintainers - Running a NATS service which is exposed to untrusted users presents a heightened risk. Any remote execution flaw or equivalent seriousness, or denial-of-service by unauthenticated users, will lead to prompt releases by the NATS maintainers. Fixes for denial of service issues with no threat of remote execution, when limited to account holders, are likely to just be committed to the main development branch with no special attention. Those who are running such services are encouraged to build regularly from git.",
              "affected": [
                {
                  "package": {
                    "ecosystem": "Go",
                    "name": "github.com/nats-io/nats-server",
                    "purl": "pkg:golang/github.com/nats-io/nats-server"
                  },
                  "ranges": [
                    {
                      "type": "SEMVER",
                      "events": [
                        {
                          "introduced": "0"
                        },
                        {
                          "fixed": "2.2.0"
                        }
                      ]
                    }
                  ],
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-m4jx-6526-vvhm/GHSA-m4jx-6526-vvhm.json"
                  }
                },
                {
                  "package": {
                    "ecosystem": "Go",
                    "name": "github.com/nats-io/nats-server/v2",
                    "purl": "pkg:golang/github.com/nats-io/nats-server/v2"
                  },
                  "ranges": [
                    {
                      "type": "SEMVER",
                      "events": [
                        {
                          "introduced": "0"
                        },
                        {
                          "fixed": "2.2.0"
                        }
                      ]
                    }
                  ],
                  "database_specific": {
                    "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-m4jx-6526-vvhm/GHSA-m4jx-6526-vvhm.json"
                  }
                }
              ],
              "severity": [
                {
                  "type": "CVSS_V3",
                  "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
                }
              ],
              "references": [
                {
                  "type": "ADVISORY",
                  "url": "https://nvd.nist.gov/vuln/detail/CVE-2020-28466"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/nats-io/nats-server/pull/1731"
                },
                {
                  "type": "WEB",
                  "url": "https://github.com/nats-io/nats-server/pull/1731/commits/2e3c22672936f4980d343fb1d328b38919e74796"
                },
                {
                  "type": "WEB",
                  "url": "https://snyk.io/vuln/SNYK-GOLANG-GITHUBCOMNATSIONATSSERVERSERVER-1042967"
                },
                {
                  "type": "WEB",
                  "url": "http://www.openwall.com/lists/oss-security/2021/03/16/1"
                },
                {
                  "type": "WEB",
                  "url": "http://www.openwall.com/lists/oss-security/2021/03/16/2"
                }
              ],
              "database_specific": {
                "cwe_ids": [
                  "CWE-400"
                ],
                "github_reviewed": true,
                "github_reviewed_at": "2021-05-12T20:38:22Z",
                "nvd_published_at": null,
                "severity": "HIGH"
              }
            }
          ],
          "groups": [
            {
              "ids": [
                "GHSA-2c64-vj8g-vwrq",
                "GHSA-4w5x-x539-ppf5"
              ]
            },
            {
              "ids": [
                "GHSA-h2fg-54x9-5qhq",
                "GHSA-hmm9-r2m2-qg9w"
              ]
            },
            {
              "ids": [
                "GHSA-9r5x-fjv3-q6h4",
                "GHSA-j756-f273-xhp4"
              ]
            },
            {
              "ids": [
                "GHSA-gwj5-3vfq-q992"
              ]
            },
            {
              "ids": [
                "GHSA-jp4j-47f9-2vc3"
              ]
            },
            {
              "ids": [
                "GHSA-m4jx-6526-vvhm"
              ]
            }
          ]
        },
        {
          "package": {
            "name": "stdlib",
            "version": "1.21.4",
            "ecosystem": "Go",
            "commit": ""
          },
          "vulnerabilities": [
            {
              "modified": "2023-12-06T16:22:45Z",
              "published": "2023-11-08T22:42:14Z",
              "schema_version": "1.6.0",
              "id": "GO-2023-2185",
              "aliases": [
                "BIT-golang-2023-45283",
                "CVE-2023-45283"
              ],
              "summary": "Insecure parsing of Windows paths with a \\??\\ prefix in path/filepath",
              "details": "The filepath package does not recognize paths with a \\??\\ prefix as special.\n\nOn Windows, a path beginning with \\??\\ is a Root Local Device path equivalent to a path beginning with \\\\?\\. Paths with a \\??\\ prefix may be used to access arbitrary locations on the system. For example, the path \\??\\c:\\x is equivalent to the more common path c:\\x.\n\nBefore fix, Clean could convert a rooted path such as \\a\\..\\??\\b into the root local device path \\??\\b. Clean will now convert this to .\\??\\b.\n\nSimilarly, Join(\\, ??, b) could convert a seemingly innocent sequence of path elements into the root local device path \\??\\b. Join will now convert this to \\.\\??\\b.\n\nIn addition, with fix, IsAbs now correctly reports paths beginning with \\??\\ as absolute, and VolumeName correctly reports the \\??\\ prefix as a volume name.\n\nUPDATE: Go 1.20.11 and Go 1.21.4 inadvertently changed the definition of the volume name in Windows paths starting with \\?, resulting in filepath.Clean(\\?\\c:) returning \\?\\c: rather than \\?\\c:\\ (among other effects). The previous behavior has been restored.",
              "affected": [
                {
                  "package": {
                    "ecosystem": "Go",
                    "name": "stdlib",
                    "purl": "pkg:golang/stdlib"
                  },
                  "ranges": [
                    {
                      "type": "SEMVER",
                      "events": [
                        {
                          "introduced": "0"
                        },
                        {
                          "fixed": "1.20.11"
                        },
                        {
                          "introduced": "1.21.0-0"
                        },
                        {
                          "fixed": "1.21.4"
                        }
                      ]
                    }
                  ],
                  "database_specific": {
                    "source": "https://vuln.go.dev/ID/GO-2023-2185.json"
                  },
                  "ecosystem_specific": {
                    "imports": [
                      {
                        "goos": [
                          "windows"
                        ],
                        "path": "path/filepath",
                        "symbols": [
                          "Abs",
                          "Base",
                          "Clean",
                          "Dir",
                          "EvalSymlinks",
                          "Glob",
                          "IsLocal",
                          "Join",
                          "Rel",
                          "Split",
                          "VolumeName",
                          "Walk",
                          "WalkDir",
                          "join",
                          "volumeNameLen"
                        ]
                      },
                      {
                        "goos": [
                          "windows"
                        ],
                        "path": "internal/safefilepath",
                        "symbols": [
                          "FromFS",
                          "fromFS"
                        ]
                      }
                    ]
                  }
                },
                {
                  "package": {
                    "ecosystem": "Go",
                    "name": "stdlib",
                    "purl": "pkg:golang/stdlib"
                  },
                  "ranges": [
                    {
                      "type": "SEMVER",
                      "events": [
                        {
                          "introduced": "1.20.11"
                        },
                        {
                          "fixed": "1.20.12"
                        },
                        {
                          "introduced": "1.21.4"
                        },
                        {
                          "fixed": "1.21.5"
                        }
                      ]
                    }
                  ],
                  "database_specific": {
                    "source": "https://vuln.go.dev/ID/GO-2023-2185.json"
                  },
                  "ecosystem_specific": {
                    "imports": [
                      {
                        "goos": [
                          "windows"
                        ],
                        "path": "path/filepath",
                        "symbols": [
                          "Abs",
                          "Base",
                          "Clean",
                          "Dir",
                          "EvalSymlinks",
                          "Glob",
                          "IsLocal",
                          "Join",
                          "Rel",
                          "Split",
                          "VolumeName",
                          "Walk",
                          "WalkDir",
                          "volumeNameLen"
                        ]
                      }
                    ]
                  }
                }
              ],
              "references": [
                {
                  "type": "REPORT",
                  "url": "https://go.dev/issue/63713"
                },
                {
                  "type": "FIX",
                  "url": "https://go.dev/cl/540277"
                },
                {
                  "type": "WEB",
                  "url": "https://groups.google.com/g/golang-announce/c/4tU8LZfBFkY"
                },
                {
                  "type": "REPORT",
                  "url": "https://go.dev/issue/64028"
                },
                {
                  "type": "FIX",
                  "url": "https://go.dev/cl/541175"
                },
                {
                  "type": "WEB",
                  "url": "https://groups.google.com/g/golang-dev/c/6ypN5EjibjM/m/KmLVYH_uAgAJ"
                }
              ],
              "database_specific": {
                "url": "https://pkg.go.dev/vuln/GO-2023-2185"
              }
            },
            {
              "modified": "2023-12-06T16:41:28Z",
              "published": "2023-12-06T16:22:36Z",
              "schema_version": "1.6.0",
              "id": "GO-2023-2382",
              "aliases": [
                "CVE-2023-39326"
              ],
              "summary": "Denial of service via chunk extensions in net/http",
              "details": "A malicious HTTP sender can use chunk extensions to cause a receiver reading from a request or response body to read many more bytes from the network than are in the body.\n\nA malicious HTTP client can further exploit this to cause a server to automatically read a large amount of data (up to about 1GiB) when a handler fails to read the entire body of a request.\n\nChunk extensions are a little-used HTTP feature which permit including additional metadata in a request or response body sent using the chunked encoding. The net/http chunked encoding reader discards this metadata. A sender can exploit this by inserting a large metadata segment with each byte transferred. The chunk reader now produces an error if the ratio of real body to encoded bytes grows too small.",
              "affected": [
                {
                  "package": {
                    "ecosystem": "Go",
                    "name": "stdlib",
                    "purl": "pkg:golang/stdlib"
                  },
                  "ranges": [
                    {
                      "type": "SEMVER",
                      "events": [
                        {
                          "introduced": "0"
                        },
                        {
                          "fixed": "1.20.12"
                        },
                        {
                          "introduced": "1.21.0-0"
                        },
                        {
                          "fixed": "1.21.5"
                        }
                      ]
                    }
                  ],
                  "database_specific": {
                    "source": "https://vuln.go.dev/ID/GO-2023-2382.json"
                  },
                  "ecosystem_specific": {
                    "imports": [
                      {
                        "path": "net/http/internal",
                        "symbols": [
                          "chunkedReader.Read",
                          "chunkedReader.beginChunk",
                          "readChunkLine"
                        ]
                      }
                    ]
                  }
                }
              ],
              "references": [
                {
                  "type": "REPORT",
                  "url": "https://go.dev/issue/64433"
                },
                {
                  "type": "FIX",
                  "url": "https://go.dev/cl/547335"
                },
                {
                  "type": "WEB",
                  "url": "https://groups.google.com/g/golang-dev/c/6ypN5EjibjM/m/KmLVYH_uAgAJ"
                }
              ],
              "credits": [
                {
                  "name": "Bartek Nowotarski"
                }
              ],
              "database_specific": {
                "url": "https://pkg.go.dev/vuln/GO-2023-2382"
              }
            }
          ],
          "groups": [
            {
              "ids": [
                "GO-2023-2185"
              ]
            },
            {
              "ids": [
                "GO-2023-2382"
              ]
            }
          ]
        }
      ]
    }
  ]
}
